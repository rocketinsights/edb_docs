---
title: Dynamic Runtime Instrumentation Tools Architecture (DRITA)
---


The Dynamic Runtime Instrumentation Tools Architecture (DRITA) allows a DBA to query catalog views to determine the *wait events* that affect the performance of individual sessions or the system as a whole. DRITA records the number of times each event occurs as well as the time spent waiting; you can use this information to diagnose performance problems. DRITA offers this functionality, while consuming minimal system resources.

DRITA compares *snapshots* to evaluate the performance of a system. A snapshot is a saved set of system performance data at a given point in time. Each snapshot is identified by a unique ID number; you can use snapshot ID numbers with DRITA reporting functions to return system performance statistics.

## Configuring and Using DRITA

Advanced Server's postgresql.conf file includes a configuration parameter named timed\_statistics that controls the collection of timing data. The valid parameter values are TRUE or FALSE; the default value is FALSE.

This is a dynamic parameter which can be modified in the postgresql.conf file, or while a session is in progress. To enable DRITA, you must either:

> Modify the postgresql.conf file, setting the timed\_statistics parameter to TRUE.
>
> or
>
> Connect to the server with the EDB-PSQL client, and invoke the command:
>
> SET timed\_statistics = TRUE

After modifying the timed\_statistics parameter, take a starting snapshot. A snapshot captures the current state of each timer and event counter. The server will compare the starting snapshot to a later snapshot to gauge system performance.

Use the edbsnap() function to take the beginning snapshot:

edb=\# SELECT \* FROM edbsnap();

edbsnap

\----------------------

Statement processed.

(1 row)

Then, run the workload that you would like to evaluate; when the workload has completed (or at a strategic point during the workload), take another snapshot:

edb=\# SELECT \* FROM edbsnap();

edbsnap

\----------------------

Statement processed.

(1 row)

You can capture multiple snapshots during a session. Then, use the DRITA functions and reports to manage and compare the snapshots to evaluate performance information.

## DRITA Functions

You can use DRITA functions to gather wait information and manage snapshots. Please note that some functions are not supported in versions of Advanced Server prior to 9.4 when installed in PostgreSQL-compatible mode.

DRITA functions are fully supported in Advanced Server 9.4 when installed in either Oracle-compatible or PostgreSQL-compatible mode.

### get\_snaps()

The get\_snaps() function returns a list of the current snapshots. The signature is:

> get\_snaps()

The following example demonstrates using the get\_snaps() function to display a list of snapshots:

edb=\# SELECT \* FROM get\_snaps();

get\_snaps

\------------------------------

1 11-FEB-10 10:41:05.668852

2 11-FEB-10 10:42:27.26154

3 11-FEB-10 10:45:48.999992

4 11-FEB-10 11:01:58.345163

5 11-FEB-10 11:05:14.092683

6 11-FEB-10 11:06:33.151002

7 11-FEB-10 11:11:16.405664

8 11-FEB-10 11:13:29.458405

9 11-FEB-10 11:23:57.595916

10 11-FEB-10 11:29:02.214014

11 11-FEB-10 11:31:44.244038

(11 rows)

The first column in the list of snapshots contains the session identifier; the DRITA functions use the session identifier to operate on a specific snapshot.

### sys\_rpt()

The sys\_rpt() function returns system wait information. The signature is:

> sys\_rpt(*beginning\_id*, *ending\_id*, *top\_n*)

Parameters

*beginning*\_*id*

*beginning*\_*id* is an integer value that represents the beginning session identifier.

*ending*\_*id*

*ending*\_*id* is an integer value that represents the ending session identifier.

*top\_n*

*top\_n* represents the number of rows to return

This example demonstrates a call to the sys\_rpt()function:

edb=\# SELECT \* FROM sys\_rpt(9, 10, 10);

sys\_rpt

\-----------------------------------------------------------------------------

WAIT NAME COUNT WAIT TIME % WAIT

\---------------------------------------------------------------------------

wal write 21250 104.723772 36.31

db file read 121407 72.143274 25.01

wal flush 84185 51.652495 17.91

wal file sync 712 29.482206 10.22

infinitecache write 84178 15.814444 5.48

db file write 84177 14.447718 5.01

infinitecache read 672 0.098691 0.03

db file extend 190 0.040386 0.01

query plan 52 0.024400 0.01

wal insert lock acquire 4 0.000837 0.00

(12 rows)

### sess\_rpt()

The sess\_rpt() function returns session wait information. The signature is:

> sess\_rpt(*beginning\_id*, *ending\_id, top\_n*)

Parameters

*beginning*\_*id*

*beginning\_id* is an integer value that represents the beginning session identifier.

*ending\_id*

*ending\_id* is an integer value that represents the ending session identifier.

*top\_n*

*top\_n* represents the number of rows to return

The following example demonstrates a call to the sess\_rpt()function:

SELECT \* FROM sess\_rpt(18, 19, 10);

sess\_rpt

\-----------------------------------------------------------------------------

ID USER WAIT NAME COUNT TIME(ms) %WAIT SES %WAIT ALL

\----------------------------------------------------------------------------

17373 enterprise db file read 30 0.175713 85.24 85.24

17373 enterprise query plan 18 0.014930 7.24 7.24

17373 enterprise wal flush 6 0.004067 1.97 1.97

17373 enterprise wal write 1 0.004063 1.97 1.97

17373 enterprise wal file sync 1 0.003664 1.78 1.78

17373 enterprise infinitecache read 38 0.003076 1.49 1.49

17373 enterprise infinitecache write 5 0.000548 0.27 0.27

17373 enterprise db file extend 190 0.04.386 0.03 0.03

17373 enterprise db file write 5 0.000082 0.04 0.04

17373 enterprise wal write lock acquire 0 0.000000 0.00 0.00

17373 enterprise bgwriter comm lock ac 0 0.000000 0.00 0.00

(13 rows)

### sessid\_rpt()

The sessid\_rpt() function returns session ID information for a specified backend. The signature is:

> sessid\_rpt(*beginning\_id*, *ending\_id, backend\_id*)

Parameters

*beginning\_id*

*beginning\_id* is an integer value that represents the beginning session identifier.

*ending\_id*

*ending\_id* is an integer value that represents the ending session identifier.

*backend\_id*

*backend\_id* is an integer value that represents the backend identifier.

The following code sample demonstrates a call to sessid\_rpt():

SELECT \* FROM sessid\_rpt(18, 19, 17373);

sessid\_rpt

\-----------------------------------------------------------------------------

ID USER WAIT NAME COUNT TIME(ms) %WAIT SES %WAIT ALL

\----------------------------------------------------------------------------

17373 enterprise db file read 30 0.175713 85.24 85.24

17373 enterprise query plan 18 0.014930 7.24 7.24

17373 enterprise wal flush 6 0.004067 1.97 1.97

17373 enterprise wal write 1 0.004063 1.97 1.97

17373 enterprise wal file sync 1 0.003664 1.78 1.78

17373 enterprise infinitecache read 38 0.003076 1.49 1.49

17373 enterprise infinitecache write 5 0.000548 0.27 0.27

17373 enterprise db file extend 190 0.040386 0.03 0.03

17373 enterprise db file write 5 0.000082 0.04 0.04

17373 enterprise wal write lock acquire 0 0.000000 0.00 0.00

17373 enterprise bgwriter comm lock ac 0 0.000000 0.00 0.00

(13 rows)

### sesshist\_rpt()

The sesshist\_rpt() function returns session wait information for a specified backend. The signature is:

> sesshist\_rpt(*snapshot\_id*, *session\_id*)

Parameters

*snapshot\_id*

*snapshot\_id* is an integer value that identifies the snapshot.

*session\_id*

*session\_id* is an integer value that represents the session.

The following example demonstrates a call to the sesshist\_rpt()function:

edb=\# SELECT \* FROM sesshist\_rpt (9, 5531);

sesshist\_rpt

\----------------------------------------------------------------------------

ID USER SEQ WAIT NAME

ELAPSED(ms) File Name \# of Blk Sum of Blks

\----------------------------------------------------------------------------

5531 enterprise 1 db file read

18546 14309 session\_waits\_pk 1 1

5531 enterprise 2 infinitecache read

125 14309 session\_waits\_pk 1 1

5531 enterprise 3 db file read

376 14304 edb$session\_waits 0 1

5531 enterprise 4 infinitecache read

166 14304 edb$session\_waits 0 1

5531 enterprise 5 db file read

7978 1260 pg\_authid 0 1

5531 enterprise 6 infinitecache read

154 1260 pg\_authid 0 1

5531 enterprise 7 db file read

628 14302 system\_waits\_pk 1 1

5531 enterprise 8 infinitecache read

463 14302 system\_waits\_pk 1 1

5531 enterprise 9 db file read

3446 14297 edb$system\_waits 0 1

5531 enterprise 10 infinitecache read

187 14297 edb$system\_waits 0 1

5531 enterprise 11 db file read

14750 14295 snap\_pk 1 1

5531 enterprise 12 infinitecache read

416 14295 snap\_pk 1 1

5531 enterprise 13 db file read

7139 14290 edb$snap 0 1

5531 enterprise 14 infinitecache read

158 14290 edb$snap 0 1

5531 enterprise 15 db file read

27287 14288 snapshot\_num\_seq 0 1

5531 enterprise 16 infinitecache read

180 14288 snapshot\_num\_seq 0 1

5531 enterprise 17 query plan

26 0 N/A 0 0

5531 enterprise 18 db file read

84552 16396 pgbench\_accounts 4358 1

5531 enterprise 19 infinitecache read

226 16396 pgbench\_accounts 4358 1

5531 enterprise 20 db file read

334838 16401 pgbench\_accounts\_pke 7792 1

5531 enterprise 21 infinitecache read

213 16401 pgbench\_accounts\_pke 7792 1

5531 enterprise 22 db file read

52619 16396 pgbench\_accounts 24829 1

5531 enterprise 23 infinitecache read

210 16396 pgbench\_accounts 24829 1

5531 enterprise 24 infinitecache read

216 16401 pgbench\_accounts\_pke 13460 1

5531 enterprise 25 db file read

13925 16396 pgbench\_accounts 27695 1

(27 rows)

### purgesnap()

The purgesnap() function purges a range of snapshots from the snapshot tables. The signature is:

> purgesnap(*beginning\_id*, *ending\_id*)

Parameters

*beginning*\_*id*

*beginning*\_*id* is an integer value that represents the beginning session identifier.

*ending*\_*id*

*ending*\_*id* is an integer value that represents the ending session identifier.

purgesnap()removes all snapshots between *beginning*\_*id* and *ending\_id* (inclusive):

SELECT \* FROM purgesnap(6, 9);

purgesnap

\------------------------------------

Snapshots in range 6 to 9 deleted.

(1 row)

A call to the get\_snaps() function after executing the example shows that snapshots 6 through 9 have been purged from the snapshot tables:

edb=\# SELECT \* FROM get\_snaps();

get\_snaps

\------------------------------

1 11-FEB-10 10:41:05.668852

2 11-FEB-10 10:42:27.26154

3 11-FEB-10 10:45:48.999992

4 11-FEB-10 11:01:58.345163

5 11-FEB-10 11:05:14.092683

10 11-FEB-10 11:29:02.214014

11 11-FEB-10 11:31:44.244038

(7 rows)

### truncsnap()

Use the truncsnap() function to delete all records from the snapshot table. The signature is:

> truncsnap()

For example:

SELECT \* FROM truncsnap();

truncsnap

\----------------------

Snapshots truncated.

(1 row)

A call to the get\_snaps() function after calling the truncsnap() function shows that all records have been removed from the snapshot tables:

SELECT \* FROM get\_snaps();

get\_snaps

\-----------

(0 rows)

## Simulating Statspack AWR Reports

The functions described in this section return information comparable to the information contained in an Oracle Statspack/AWR (Automatic Workload Repository) report. When taking a snapshot, performance data from system catalog tables is saved into history tables. The reporting functions listed below report on the differences between two given snapshots.
 - stat\_db\_rpt()
 - stat\_tables\_rpt()
 - statio\_tables\_rpt()
 - stat\_indexes\_rpt()
 - statio\_indexes\_rpt()

The reporting functions can be executed individually or you can execute all five functions by calling the edbreport() function.

### edbreport()

The edbreport() function includes data from the other reporting functions, plus additional system information. The signature is:

> edbreport(beginning\_id, ending\_id)

Parameters

beginning\_id

beginning\_id is an integer value that represents the beginning session identifier.

ending\_id

ending\_id is an integer value that represents the ending session identifier.

The following code sample demonstrates a call to the edbreport() function:

edb=\# SELECT \* FROM edbreport(9, 10);

edbreport

\-------------------------------------------------------------------------------------------------------------------------------------------------------

EnterpriseDB Report for database edb 23-AUG-12

Version: EnterpriseDB 9.4.0.0 on i686-pc-linux-gnu, compiled by gcc (GCC) 4.1.2 20080704 (Red Hat 4.1.2-52), 32-bit

Begin snapshot: 9 at 23-AUG-12 13:45:07.165123

End snapshot: 10 at 23-AUG-12 13:45:35.653036

Size of database edb is 155 MB

Tablespace: pg\_default Size: 179 MB Owner: enterprisedb

Tablespace: pg\_global Size: 435 kB Owner: enterprisedb

Schema: pg\_toast\_temp\_1 Size: 0 bytes Owner: enterprisedb

Schema: public Size: 0 bytes Owner: enterprisedb

Schema: enterprisedb Size: 143 MB Owner: enterprisedb

Schema: pgagent Size: 192 kB Owner: enterprisedb

Schema: dbms\_job\_procedure Size: 0 bytes Owner: enterprisedb

Top 10 Relations by pages

TABLE RELPAGES

\----------------------------------------------------------------------------------

pgbench\_accounts 15874

pg\_proc 102

edb$statio\_all\_indexes 73

edb$stat\_all\_indexes 73

pg\_attribute 67

pg\_depend 58

edb$statio\_all\_tables 49

edb$stat\_all\_tables 47

pgbench\_tellers 37

pg\_description 32

Top 10 Indexes by pages

INDEX RELPAGES

\----------------------------------------------------------------------------------

pgbench\_accounts\_pkey 2198

pg\_depend\_depender\_index 32

pg\_depend\_reference\_index 31

pg\_proc\_proname\_args\_nsp\_index 30

pg\_attribute\_relid\_attnam\_index 23

pg\_attribute\_relid\_attnum\_index 17

pg\_description\_o\_c\_o\_index 15

edb$statio\_idx\_pk 11

edb$stat\_idx\_pk 11

pg\_proc\_oid\_index 9

Top 10 Relations by DML

SCHEMA RELATION UPDATES DELETES INSERTS

\--------------------------------------------------------------------------------------------------

enterprisedb pgbench\_accounts 10400 0 1000000

enterprisedb pgbench\_tellers 10400 0 100

enterprisedb pgbench\_branches 10400 0 10

enterprisedb pgbench\_history 0 0 10400

pgagent pga\_jobclass 0 0 6

pgagent pga\_exception 0 0 0

pgagent pga\_job 0 0 0

pgagent pga\_jobagent 0 0 0

pgagent pga\_joblog 0 0 0

pgagent pga\_jobstep 0 0 0

DATA from pg\_stat\_database

DATABASE NUMBACKENDS XACT COMMIT XACT ROLLBACK BLKS READ BLKS HIT BLKS ICACHE HIT HIT RATIO ICACHE HIT RATIO

\------------------------------------------------------------------------------------------------------------------------------

edb 0 142 0 78 10446 0 99.26 0.00

DATA from pg\_buffercache not included because pg\_buffercache is not installed

DATA from pg\_stat\_all\_tables ordered by seq scan

SCHEMA RELATION SEQ SCAN REL TUP READ IDX SCAN IDX TUP READ INS UPD DEL

\-----------------------------------------------------------------------------------------------------------------------

pg\_catalog pg\_class 16 7162 546 319 0 1 0

pg\_catalog pg\_am 13 13 0 0 0 0 0

pg\_catalog pg\_database 4 16 42 42 0 0 0

pg\_catalog pg\_index 4 660 145 149 0 0 0

pg\_catalog pg\_namespace 4 100 49 49 0 0 0

sys edb$snap 1 9 0 0 1 0 0

pg\_catalog pg\_authid 1 1 25 25 0 0 0

sys edb$session\_wait\_history 0 0 0 0 50 0 0

sys edb$session\_waits 0 0 0 0 2 0 0

sys edb$stat\_all\_indexes 0 0 0 0 165 0 0

DATA from pg\_stat\_all\_tables ordered by rel tup read

SCHEMA RELATION SEQ SCAN REL TUP READ IDX SCAN IDX TUP READ INS UPD DEL

\-----------------------------------------------------------------------------------------------------------------------

pg\_catalog pg\_class 16 7162 546 319 0 1 0

pg\_catalog pg\_index 4 660 145 149 0 0 0

pg\_catalog pg\_namespace 4 100 49 49 0 0 0

pg\_catalog pg\_database 4 16 42 42 0 0 0

pg\_catalog pg\_am 13 13 0 0 0 0 0

sys edb$snap 1 9 0 0 1 0 0

pg\_catalog pg\_authid 1 1 25 25 0 0 0

sys edb$session\_wait\_history 0 0 0 0 50 0 0

sys edb$session\_waits 0 0 0 0 2 0 0

sys edb$stat\_all\_indexes 0 0 0 0 165 0 0

DATA from pg\_statio\_all\_tables

SCHEMA RELATION HEAP HEAP HEAP IDX IDX IDX TOAST TOAST TOAST TIDX TIDX TIDX

READ HIT ICACHE READ HIT ICACHE READ HIT ICACHE READ HIT ICACHE

HIT HIT HIT HIT

\-----------------------------------------------------------------------------------------------------------------------------------------------------

pg\_catalog pg\_class 0 539 0 0 1117 0 0 0 0 0 0 0

enterprisedb pgbench\_accounts 48 485 0 1 778 0 0 0 0 0 0 0

pg\_catalog pg\_attribute 0 447 0 0 867 0 0 0 0 0 0 0

enterprisedb pgbench\_branches 0 439 0 0 114 0 0 0 0 0 0 0

enterprisedb pgbench\_tellers 0 357 0 0 112 0 0 0 0 0 0 0

pg\_catalog pg\_statistic 1 293 0 0 441 0 0 0 0 0 0 0

pg\_catalog pg\_index 0 159 0 0 171 0 0 0 0 0 0 0

pg\_catalog pg\_opclass 0 145 0 0 68 0 0 0 0 0 0 0

pg\_catalog pg\_proc 0 135 0 0 294 0 0 0 0 0 0 0

pg\_catalog pg\_type 0 103 0 0 322 0 0 0 0 0 0 0

DATA from pg\_stat\_all\_indexes

SCHEMA RELATION INDEX IDX SCAN IDX TUP READ IDX TUP FETCH

\-------------------------------------------------------------------------------------------------------------------------

pg\_catalog pg\_attribute pg\_attribute\_relid\_attnum\_index 427 907 907

pg\_catalog pg\_class pg\_class\_relname\_nsp\_index 289 62 62

pg\_catalog pg\_class pg\_class\_oid\_index 257 257 257

pg\_catalog pg\_statistic pg\_statistic\_relid\_att\_inh\_index 207 196 196

enterprisedb pgbench\_accounts pgbench\_accounts\_pkey 200 255 200

pg\_catalog pg\_cast pg\_cast\_source\_target\_index 199 50 50

pg\_catalog pg\_proc pg\_proc\_oid\_index 116 116 116

pg\_catalog edb\_partition edb\_partition\_partrelid\_index 112 0 0

pg\_catalog edb\_policy edb\_policy\_object\_name\_index 112 0 0

enterprisedb pgbench\_branches pgbench\_branches\_pkey 101 110 0

DATA from pg\_statio\_all\_indexes

SCHEMA RELATION INDEX IDX BLKS READ IDX BLKS HIT IDX BLKS ICACHE HIT

\---------------------------------------------------------------------------------------------------------------------------------------

pg\_catalog pg\_attribute pg\_attribute\_relid\_attnum\_index 0 867 0

enterprisedb pgbench\_accounts pgbench\_accounts\_pkey 1 778 0

pg\_catalog pg\_class pg\_class\_relname\_nsp\_index 0 590 0

pg\_catalog pg\_class pg\_class\_oid\_index 0 527 0

pg\_catalog pg\_statistic pg\_statistic\_relid\_att\_inh\_index 0 441 0

sys edb$stat\_all\_indexes edb$stat\_idx\_pk 1 332 0

sys edb$statio\_all\_indexes edb$statio\_idx\_pk 1 332 0

pg\_catalog pg\_proc pg\_proc\_oid\_index 0 244 0

sys edb$stat\_all\_tables edb$stat\_tab\_pk 0 241 0

sys edb$statio\_all\_tables edb$statio\_tab\_pk 0 241 0

System Wait Information

WAIT NAME COUNT WAIT TIME % WAIT

\---------------------------------------------------------------------------

query plan 0 0.000407 100.00

db file read 0 0.000000 0.00

Database Parameters from postgresql.conf

PARAMETER SETTING CONTEXT MINVAL MAXVAL

\-------------------------------------------------------------------------------------------------------------------------

allow\_system\_table\_mods off postmaster

application\_name psql user

archive\_command (disabled) sighup

archive\_mode off postmaster

archive\_timeout 0 sighup 0 2147483647

array\_nulls on user

authentication\_timeout 60 sighup 1 600

autovacuum on sighup

autovacuum\_analyze\_scale\_factor 0.1 sighup 0 100

autovacuum\_analyze\_threshold 50 sighup 0 2147483647

autovacuum\_freeze\_max\_age 200000000 postmaster 100000000 2000000000

autovacuum\_max\_workers 3 postmaster 1 8388607

autovacuum\_naptime 60 sighup 1 2147483

autovacuum\_vacuum\_cost\_delay 20 sighup -1 100

autovacuum\_vacuum\_cost\_limit -1 sighup -1 10000

autovacuum\_vacuum\_scale\_factor 0.2 sighup 0 100

autovacuum\_vacuum\_threshold 50 sighup 0 2147483647

backslash\_quote safe\_encoding user

bgwriter\_delay 200 sighup 10 10000

bgwriter\_lru\_maxpages 100 sighup 0 1000

bgwriter\_lru\_multiplier 2 sighup 0 10

block\_size 8192 internal 8192 8192

bonjour off postmaster

bonjour\_name postmaster

bytea\_output hex user

check\_function\_bodies on user

checkpoint\_completion\_target 0.5 sighup 0 1

checkpoint\_segments 64 sighup 1 2147483647

checkpoint\_timeout 300 sighup 30 3600

checkpoint\_warning 30 sighup 0 2147483647

client\_encoding UTF8 user

client\_min\_messages notice user

commit\_delay 0 user 0 100000

commit\_siblings 5 user 0 1000

config\_file /opt/PostgresPlus/9.4AS/data/postgresql. postmaster

constraint\_exclusion partition user

cpu\_index\_tuple\_cost 0.005 user 0 1.79769e+308

cpu\_operator\_cost 0.0025 user 0 1.79769e+308

cpu\_tuple\_cost 0.01 user 0 1.79769e+308

cursor\_tuple\_fraction 0.1 user 0 1

data\_directory /opt/PostgresPlus/9.4AS/data postmaster

DateStyle Redwood, SHOW\_TIME user

db\_dialect redwood user

dbms\_alert.max\_alerts 100 postmaster 0 500

dbms\_pipe.total\_message\_buffer 30 postmaster 30 262144

db\_user\_namespace off sighup

deadlock\_timeout 1000 superuser 1 2147483647

debug\_assertions off user

debug\_pretty\_print on user

debug\_print\_parse off user

debug\_print\_plan off user

debug\_print\_rewritten off user

default\_heap\_fillfactor 100 user 10 100

default\_statistics\_target 100 user 1 10000

default\_tablespace user

default\_text\_search\_config pg\_catalog.english user

default\_transaction\_deferrable off user

default\_transaction\_isolation read committed user

default\_transaction\_read\_only off user

default\_with\_oids off user

default\_with\_rowids off user

dynamic\_library\_path $libdir superuser

edb\_audit sighup

edb\_audit\_connect failed sighup

edb\_audit\_directory edb\_audit sighup

edb\_audit\_disconnect none sighup

edb\_audit\_filename audit-%Y%m%d\_%H%M%S sighup

edb\_audit\_rotation\_day every sighup

edb\_audit\_rotation\_seconds 0 sighup 0 2147483647

edb\_audit\_rotation\_size 0 sighup 0 5000

edb\_audit\_statement ddl, error sighup

edb\_connectby\_order on user

edb\_dynatune 66 postmaster 0 100

edb\_dynatune\_profile oltp postmaster

edb\_enable\_icache off postmaster

edb\_icache\_compression\_level 6 superuser 0 9

edb\_icache\_servers sighup

edb\_redwood\_date on user

edb\_redwood\_strings on user

edb\_stmt\_level\_tx off user

effective\_cache\_size 34277 user 1 2147483647

effective\_io\_concurrency 1 user 0 1000

enable\_bitmapscan on user

enable\_hashagg on user

enable\_hashjoin on user

enable\_hints on user

enable\_indexonlyscan on user

enable\_indexscan on user

enable\_material on user

enable\_mergejoin on user

enable\_nestloop on user

enable\_seqscan on user

enable\_sort on user

enable\_tidscan on user

escape\_string\_warning on user

event\_source PostgreSQL postmaster

exit\_on\_error off user

external\_pid\_file postmaster

extra\_float\_digits 0 user -15 3

from\_collapse\_limit 8 user 1 2147483647

fsync on sighup

full\_page\_writes on sighup

geqo on user

geqo\_effort 5 user 1 10

geqo\_generations 0 user 0 2147483647

geqo\_pool\_size 0 user 0 2147483647

geqo\_seed 0 user 0 1

geqo\_selection\_bias 2 user 1.5 2

geqo\_threshold 12 user 2 2147483647

gin\_fuzzy\_search\_limit 0 user 0 2147483647

hba\_file /opt/PostgresPlus/9.4AS/data/pg\_hba.conf postmaster

hot\_standby off postmaster

hot\_standby\_feedback off sighup

ident\_file /opt/PostgresPlus/9.4AS/data/pg\_ident.co postmaster

ignore\_system\_indexes off backend

integer\_datetimes on internal

IntervalStyle postgres user

join\_collapse\_limit 8 user 1 2147483647

krb\_caseins\_users off sighup

krb\_server\_keyfile FILE:/home/edb/AS94/edb-postgres/inst/et sighup

krb\_srvname postgres sighup

lc\_collate en\_US.UTF-8 internal

lc\_ctype en\_US.UTF-8 internal

lc\_messages en\_US.UTF-8 superuser

lc\_monetary en\_US.UTF-8 user

lc\_numeric en\_US.UTF-8 user

lc\_time en\_US.UTF-8 user

listen\_addresses \* postmaster

local\_preload\_libraries backend

lo\_compat\_privileges off superuser

log\_autovacuum\_min\_duration -1 sighup -1 2147483647

log\_checkpoints off sighup

log\_connections off backend

log\_destination stderr sighup

log\_directory pg\_log sighup

log\_disconnections off backend

log\_duration off superuser

log\_error\_verbosity default superuser

log\_executor\_stats off superuser

log\_file\_mode 0600 sighup 0 511

log\_filename enterprisedb-%Y-%m-%d\_%H%M%S.log sighup

logging\_collector on postmaster

log\_hostname off sighup

log\_line\_prefix %t sighup

log\_lock\_waits off superuser

log\_min\_duration\_statement -1 superuser -1 2147483647

log\_min\_error\_statement error superuser

log\_min\_messages warning superuser

log\_parser\_stats off superuser

log\_planner\_stats off superuser

log\_rotation\_age 1440 sighup 0 35791394

log\_rotation\_size 10240 sighup 0 2097151

log\_statement none superuser

log\_statement\_stats off superuser

log\_temp\_files -1 superuser -1 2147483647

log\_timezone US/Eastern sighup

log\_truncate\_on\_rotation off sighup

maintenance\_work\_mem 36871 user 1024 2097151

max\_connections 100 postmaster 1 8388607

max\_files\_per\_process 1000 postmaster 25 2147483647

max\_function\_args 256 internal 256 256

max\_identifier\_length 63 internal 63 63

max\_index\_keys 32 internal 32 32

max\_locks\_per\_transaction 64 postmaster 10 2147483647

max\_pred\_locks\_per\_transaction 64 postmaster 10 2147483647

max\_prepared\_transactions 0 postmaster 0 8388607

max\_stack\_depth 2048 superuser 100 2097151

max\_standby\_archive\_delay 30000 sighup -1 2147483647

max\_standby\_streaming\_delay 30000 sighup -1 2147483647

max\_wal\_senders 0 postmaster 0 8388607

odbc\_lib\_path postmaster

optimizer\_mode choose user

oracle\_home postmaster

password\_encryption on user

plpgsql.variable\_conflict error superuser

port 5444 postmaster 1 65535

post\_auth\_delay 0 backend 0 2147483647

pre\_auth\_delay 0 sighup 0 60

qreplace\_function superuser

quote\_all\_identifiers off user

random\_page\_cost 4 user 0 1.79769e+308

replication\_timeout 60000 sighup 0 2147483647

restart\_after\_crash on sighup

search\_path "$user",public user

segment\_size 131072 internal 131072 131072

seq\_page\_cost 1 user 0 1.79769e+308

server\_encoding UTF8 internal

server\_version 9.4.0.0 internal

server\_version\_num 90200 internal 90200 90200

session\_replication\_role origin superuser

shared\_buffers 23540 postmaster 16 1073741823

shared\_preload\_libraries $libdir/dbms\_pipe,$libdir/edb\_gen,$libdi postmaster

sql\_inheritance on user

ssl off postmaster

ssl\_ca\_file postmaster

ssl\_cert\_file server.crt postmaster

ssl\_ciphers ALL:\!ADH:\!LOW:\!EXP:\!MD5:@STRENGTH postmaster

ssl\_crl\_file postmaster

ssl\_key\_file server.key postmaster

ssl\_renegotiation\_limit 524288 user 0 2097151

standard\_conforming\_strings on user

statement\_timeout 0 user 0 2147483647

stats\_temp\_directory pg\_stat\_tmp sighup

superuser\_reserved\_connections 3 postmaster 0 8388607

synchronize\_seqscans on user

synchronous\_commit on user

synchronous\_standby\_names sighup

syslog\_facility local0 sighup

syslog\_ident postgres sighup

tcp\_keepalives\_count 0 user 0 2147483647

tcp\_keepalives\_idle 0 user 0 2147483647

tcp\_keepalives\_interval 0 user 0 2147483647

temp\_buffers 1024 user 100 1073741823

temp\_file\_limit -1 superuser -1 2147483647

temp\_tablespaces user

timed\_statistics on user

TimeZone US/Eastern user

timezone\_abbreviations Default user

trace\_hints off user

trace\_notify off user

trace\_recovery\_messages log sighup

trace\_sort off user

track\_activities on superuser

track\_activity\_query\_size 1024 postmaster 100 102400

track\_counts on superuser

track\_functions none superuser

track\_io\_timing off superuser

transaction\_deferrable off user

transaction\_isolation read committed user

transaction\_read\_only off user

transform\_null\_equals off user

unix\_socket\_directory postmaster

unix\_socket\_group postmaster

unix\_socket\_permissions 0777 postmaster 0 511

update\_process\_title on superuser

vacuum\_cost\_delay 0 user 0 100

vacuum\_cost\_limit 200 user 1 10000

vacuum\_cost\_page\_dirty 20 user 0 10000

vacuum\_cost\_page\_hit 1 user 0 10000

vacuum\_cost\_page\_miss 10 user 0 10000

vacuum\_defer\_cleanup\_age 0 sighup 0 1000000

vacuum\_freeze\_min\_age 50000000 user 0 1000000000

vacuum\_freeze\_table\_age 150000000 user 0 2000000000

wal\_block\_size 8192 internal 8192 8192

wal\_buffers 735 postmaster -1 2147483647

wal\_keep\_segments 0 sighup 0 2147483647

wal\_level minimal postmaster

wal\_receiver\_status\_interval 10 sighup 0 2147483

wal\_segment\_size 2048 internal 2048 2048

wal\_sync\_method fdatasync sighup

wal\_writer\_delay 200 sighup 1 10000

work\_mem 3716 user 64 2097151

xmlbinary base64 user

xmloption content user

zero\_damaged\_pages off superuser

(412 rows)

### stat\_db\_rpt()

The signature is:

> stat\_db\_rpt(*beginning\_id*, *ending\_id*)

Parameters

beginning\_id

beginning\_id is an integer value that represents the beginning session identifier.

ending\_id

ending\_id is an integer value that represents the ending session identifier.

The following example demonstrates the stat\_db\_rpt() function:

SELECT \* FROM stat\_db\_rpt(9, 10);

stat\_db\_rpt

\-----------------------------------------------------------------------------

DATA from pg\_stat\_database

DATABASE NUMBACKENDS XACT COMMIT XACT ROLLBACK BLKS READ BLKS HIT

BLKS ICACHE HIT HIT RATIO ICACHE HIT RATIO

\-----------------------------------------------------------------------------

edb 1 21 0 92928 101217

301 52.05 0.15

### stat\_tables\_rpt()

The signature is:

> function\_name(*beginning\_id*, *ending\_id*, *top\_n, scope*)

Parameters

beginning\_id

beginning\_id is an integer value that represents the beginning session identifier.

ending\_id

ending\_id is an integer value that represents the ending session identifier.

top\_n

top\_n represents the number of rows to return

scope

scope determines which tables the function returns statistics about. Specify SYS, USER or ALL:
 - SYS indicates that the function should return information about system defined tables. A table is considered a system table if it is stored in one of the following schemas: pg\_catalog, information\_schema, sys, or dbo.
 - USER indicates that the function should return information about user-defined tables.
 - ALL specifies that the function should return information about all tables.

The following code sample demonstrates the stat\_tables\_rpt() function:

SELECT \* FROM stat\_tables\_rpt(18, 19, 10, 'ALL');

stat\_tables\_rpt

\-----------------------------------------------------------------------------

DATA from pg\_stat\_all\_tables ordered by seq scan

SCHEMA RELATION

SEQ SCAN REL TUP READ IDX SCAN IDX TUP READ INS UPD DEL

\-----------------------------------------------------------------------------

pg\_catalog pg\_class

8 2952 78 65 0 0 0

pg\_catalog pg\_index

4 448 23 28 0 0 0

pg\_catalog pg\_namespace

4 76 1 1 0 0 0

pg\_catalog pg\_database

3 6 0 0 0 0 0

pg\_catalog pg\_authid

2 1 0 0 0 0 0

sys edb$snap

1 15 0 0 1 0 0

public accounts

0 0 0 0 0 0 0

public branches

0 0 0 0 0 0 0

sys edb$session\_wait\_history

0 0 0 0 25 0 0

sys edb$session\_waits

0 0 0 0 10 0 0

DATA from pg\_stat\_all\_tables ordered by rel tup read

SCHEMA RELATION

SEQ SCAN REL TUP READ IDX SCAN IDX TUP READ INS UPD DEL

\-----------------------------------------------------------------------------

pg\_catalog pg\_class

8 2952 78 65 0 0 0

pg\_catalog pg\_index

4 448 23 28 0 0 0

pg\_catalog pg\_namespace

4 76 1 1 0 0 0

sys edb$snap

1 15 0 0 1 0 0

pg\_catalog pg\_database

3 6 0 0 0 0 0

pg\_catalog pg\_authid

2 1 0 0 0 0 0

public accounts

0 0 0 0 0 0 0

public branches

0 0 0 0 0 0 0

sys edb$session\_wait\_history

0 0 0 0 25 0 0

sys edb$session\_waits

0 0 0 0 10 0 0

(29 rows)

### statio\_tables\_rpt()

The signature is:

> statio\_tables\_rpt(*beginning\_id*, *ending\_id*, *top\_n*, *scope*)

Parameters

beginning\_id

beginning\_id is an integer value that represents the beginning session identifier.

ending\_id

ending\_id is an integer value that represents the ending session identifier.

top\_n

top\_n represents the number of rows to return

scope

scope determines which tables the function returns statistics about. Specify SYS, USER or ALL:
 - SYS indicates that the function should return information about system defined tables. A table is considered a system table if it is stored in one of the following schemas: pg\_catalog, information\_schema, sys, or dbo.
 - USER indicates that the function should return information about user-defined tables.
 - ALL specifies that the function should return information about all tables.

The following example demonstrates the statio\_tables\_rpt() function:

edb=\# SELECT \* FROM statio\_tables\_rpt(9, 10, 10, 'SYS');

statio\_tables\_rpt -----------------------------------------------------------------------------

DATA from pg\_statio\_all\_tables

SCHEMA RELATION HEAP HEAP HEAP IDX IDX

READ HIT ICACHE READ HIT

HIT

IDX TOAST TOAST TOAST TIDX TIDX TIDX

ICACHE READ HIT ICACHE READ HIT ICACHE

HIT HIT HIT

\-----------------------------------------------------------------------------

public pgbench\_accounts 92766 67215 288 59 32126

9 0 0 0 0 0 0

pg\_catalog pg\_class 0 296 0 3 16

0 0 0 0 0 0 0

sys edb$stat\_all\_indexes 8 125 0 4 233

0 0 0 0 0 0 0

sys edb$statio\_all\_index 8 125 0 4 233

0 0 0 0 0 0 0

sys edb$stat\_all\_tables 6 91 0 2 174

0 0 0 0 0 0 0

sys edb$statio\_all\_table 6 91 0 2 174

0 0 0 0 0 0 0

pg\_catalog pg\_namespace 3 72 0 0 0

0 0 0 0 0 0 0

sys edb$session\_wait\_his 1 24 0 4 47

0 0 0 0 0 0 0

pg\_catalog pg\_opclass 3 13 0 2 0

0 0 0 0 0 0 0

pg\_catalog pg\_trigger 0 12 0 1 15

0 0 0 0 0 0 0

(16 rows)

### stat\_indexes\_rpt()

The signature is:

> stat\_indexes\_rpt(*beginning\_id*, *ending\_id, top\_n, scope*)

Parameters

beginning\_id

beginning\_id is an integer value that represents the beginning session identifier.

ending\_id

ending\_id is an integer value that represents the ending session identifier.

top\_n

top\_n represents the number of rows to return

scope

scope determines which tables the function returns statistics about. Specify SYS, USER or ALL:
 - SYS indicates that the function should return information about system defined tables. A table is considered a system table if it is stored in one of the following schemas: pg\_catalog, information\_schema, sys, or dbo.
 - USER indicates that the function should return information about user-defined tables.
 - ALL specifies that the function should return information about all tables.

The following code sample demonstrates the stat\_indexes\_rpt() function:

edb=\# SELECT \* FROM stat\_indexes\_rpt(9, 10, 10, 'ALL');

stat\_indexes\_rpt

\-----------------------------------------------------------------------------

DATA from pg\_stat\_all\_indexes

SCHEMA RELATION INDEX

IDX SCAN IDX TUP READ IDX TUP FETCH

\-----------------------------------------------------------------------------

pg\_catalog pg\_cast pg\_cast\_source\_target\_index

30 7 7

pg\_catalog pg\_class pg\_class\_oid\_index

15 15 15

pg\_catalog pg\_trigger pg\_trigger\_tgrelid\_tgname\_index

12 12 12

pg\_catalog pg\_attribute pg\_attribute\_relid\_attnum\_index

7 31 31

pg\_catalog pg\_statistic pg\_statistic\_relid\_att\_index

7 0 0

pg\_catalog pg\_database pg\_database\_oid\_index

5 5 5

pg\_catalog pg\_proc pg\_proc\_oid\_index

5 5 5

pg\_catalog pg\_operator pg\_operator\_oprname\_l\_r\_n\_index

3 1 1

pg\_catalog pg\_type pg\_type\_typname\_nsp\_index

3 1 1

pg\_catalog pg\_amop pg\_amop\_opr\_fam\_index

2 3 3

(14 rows)

### statio\_indexes\_rpt()

The signature is:

> statio\_indexes\_rpt(*beginning\_id*, *ending\_id, top\_n, scope*)

Parameters

beginning\_id

beginning\_id is an integer value that represents the beginning session identifier.

ending\_id

ending\_id is an integer value that represents the ending session identifier.

top\_n

top\_n represents the number of rows to return

scope

scope determines which tables the function returns statistics about. Specify SYS, USER or ALL:
 - SYS indicates that the function should return information about system defined tables. A table is considered a system table if it is stored in one of the following schemas: pg\_catalog, information\_schema, sys, or dbo.
 - USER indicates that the function should return information about user-defined tables.
 - ALL specifies that the function should return information about all tables.

The following example demonstrates the statio\_indexes\_rpt() function:

edb=\# SELECT \* FROM statio\_indexes\_rpt(9, 10, 10, 'SYS');

statio\_indexes\_rpt

\-----------------------------------------------------------------------------

DATA from pg\_statio\_all\_indexes

SCHEMA RELATION INDEX

IDX BLKS READ IDX BLKS HIT IDX BLKS ICACHE HIT

\-----------------------------------------------------------------------------

public pgbench\_accounts pgbench\_accounts\_pkey

59 32126 9

sys edb$stat\_all\_indexes edb$stat\_idx\_pk

4 233 0

sys edb$statio\_all\_indexes edb$statio\_idx\_pk

4 233 0

sys edb$stat\_all\_tables edb$stat\_tab\_pk

2 174 0

sys edb$statio\_all\_tables edb$statio\_tab\_pk

2 174 0

sys edb$session\_wait\_history session\_waits\_hist\_pk

4 47 0

pg\_catalog pg\_cast pg\_cast\_source\_target\_index

1 29 0

pg\_catalog pg\_trigger pg\_trig\_tgrelid\_tgname\_index

1 15 0

pg\_catalog pg\_class pg\_class\_oid\_index

1 14 0

pg\_catalog pg\_statistic pg\_statistic\_relid\_att\_index

2 12 0

(14 rows)

## Performance Tuning Recommendations

To use DRITA reports for performance tuning, review the top five events in a given report, looking for any event that takes a disproportionately large percentage of resources. In a streamlined system, user I/O will probably make up the largest number of waits. Waits should be evaluated in the context of CPU usage and total time; an event may not be significant if it takes 2 minutes out of a total measurement interval of 2 hours, if the rest of the time is consumed by CPU time. The component of response time (CPU "work" time or other "wait" time) that consumes the highest percentage of overall time should be evaluated.

When evaluating events, watch for:

| Event type                 | Description                                                                                                                   |
| -------------------------- | ----------------------------------------------------------------------------------------------------------------------------- |
| Checkpoint waits           | Checkpoint waits may indicate that checkpoint parameters need to be adjusted, (checkpoint\_segments and checkpoint\_timeout). |
| WAL-related waits          | WAL-related waits may indicate wal\_buffers are under-sized.                                                                  |
| SQL Parse waits            | If the number of waits is high, try to use prepared statements.                                                               |
| db file random reads       | If high, check that appropriate indexes and statistics exist.                                                                 |
| db file random writes      | If high, may need to decrease bgwriter\_delay.                                                                                |
| btree random lock acquires | May indicate indexes are being rebuilt. Schedule index builds during less active time.                                        |

Performance reviews should also include careful scrutiny of the hardware, the operating system, the network and the application SQL statements.

## Event Descriptions

| Event Name                          | Description                                                                                                                                                                                                           |
| ----------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| add in shmem lock acquire           | Obsolete/unused                                                                                                                                                                                                       |
| bgwriter communication lock acquire | The bgwriter (background writer) process has waited for the short-term lock that synchronizes messages between the bgwriter and a backend process.                                                                    |
| btree vacuum lock acquire           | The server has waited for the short-term lock that synchronizes access to the next available vacuum cycle ID.                                                                                                         |
| buffer free list lock acquire       | The server has waited for the short-term lock that synchronizes access to the list of free buffers (in shared memory).                                                                                                |
| checkpoint lock acquire:            | A server process has waited for the short-term lock that prevents simultaneous checkpoints.                                                                                                                           |
| checkpoint start lock acquire       | The server has waited for the short-term lock that synchronizes access to the bgwriter checkpoint schedule.                                                                                                           |
| clog control lock acquire           | The server has waited for the short-term lock that synchronizes access to the commit log.                                                                                                                             |
| control file lock acquire           | The server has waited for the short-term lock that synchronizes write access to the control file (this should usually be a low number).                                                                               |
| db file extend                      | A server process has waited for the operating system while adding a new page to the end of a file.                                                                                                                    |
| db file read                        | A server process has waited for the completion of a read (from disk).                                                                                                                                                 |
| db file write                       | A server process has waited for the completion of a write (to disk).                                                                                                                                                  |
| db file sync                        | A server process has waited for the operating system to flush all changes to disk.                                                                                                                                    |
| first buf mapping lock acquire      | The server has waited for a short-term lock that synchronizes access to the shared-buffer mapping table.                                                                                                              |
| freespace lock acquire              | The server has waited for the short-term lock that synchronizes access to the freespace map.                                                                                                                          |
| Infinite Cache read                 | The server has waited for an Infinite Cache read request.                                                                                                                                                             |
| Infinite Cache write                | The server has waited for an Infinite Cache write request.                                                                                                                                                            |
| lwlock acquire                      | The server has waited for a short-term lock that has not been described elsewhere in this section.                                                                                                                    |
| multi xact gen lock acquire         | The server has waited for the short-term lock that synchronizes access to the next available multi-transaction ID (when a SELECT...FOR SHARE statement executes).                                                     |
| multi xact member lock acquire      | The server has waited for the short-term lock that synchronizes access to the multi-transaction member file (when a SELECT...FOR SHARE statement executes).                                                           |
| multi xact offset lock acquire      | The server has waited for the short-term lock that synchronizes access to the multi-transaction offset file (when a SELECT...FOR SHARE statement executes).                                                           |
| oid gen lock acquire                | The server has waited for the short-term lock that synchronizes access to the next available OID (object ID).                                                                                                         |
| query plan                          | The server has computed the execution plan for a SQL statement.                                                                                                                                                       |
| rel cache init lock acquire         | The server has waited for the short-term lock that prevents simultaneous relation-cache loads/unloads.                                                                                                                |
| shmem index lock acquire            | The server has waited for the short-term lock that synchronizes access to the shared-memory map.                                                                                                                      |
| sinval lock acquire                 | The server has waited for the short-term lock that synchronizes access to the cache invalidation state.                                                                                                               |
| sql parse                           | The server has parsed a SQL statement.                                                                                                                                                                                |
| subtrans control lock acquire       | The server has waited for the short-term lock that synchronizes access to the subtransaction log.                                                                                                                     |
| tablespace create lock acquire      | The server has waited for the short-term lock that prevents simultaneous CREATE TABLESPACE or DROP TABLESPACE commands.                                                                                               |
| two phase state lock acquire        | The server has waited for the short-term lock that synchronizes access to the list of prepared transactions.                                                                                                          |
| wal insert lock acquire             | The server has waited for the short-term lock that synchronizes write access to the write-ahead log. A high number may indicate that WAL buffers are sized too small.                                                 |
| wal write lock acquire              | The server has waited for the short-term lock that synchronizes write-ahead log flushes.                                                                                                                              |
| wal file sync                       | The server has waited for the write-ahead log to sync to disk (related to the wal\_sync\_method parameter which, by default, is 'fsync' - better performance can be gained by changing this parameter to open\_sync). |
| wal flush                           | The server has waited for the write-ahead log to flush to disk.                                                                                                                                                       |
| wal write                           | The server has waited for a write to the write-ahead log buffer (expect this value to be high).                                                                                                                       |
| xid gen lock acquire                | The server has waited for the short-term lock that synchronizes access to the next available transaction ID.                                                                                                          |

## Catalog Views

The following DRITA catalog views provide access to performance information relating to system waits.

### edb$system\_waits

The edb$system\_waits view summarizes the number of waits and the total wait time per session for each wait named. It also displays the average and max wait times. edb$system\_waits summarizes the following information:

Column | Type | Modifiers | Definition

\------------+---------------+-----------+------------------

edb\_id | numeric | |identifier

dbname | text | |database name

wait\_name | text | |name of the event

wait\_count | numeric | |number of times the event occurs

avg\_wait | numeric(50,6) | |average wait time in microseconds

max\_wait | numeric | |maximum wait time in microseconds

total\_wait | numeric | |total wait time in microseconds

wait\_name | text | |name of the event

The following example shows the result of a SELECT statement on the edb$system\_waits view:

select \* from sys.edb$system\_waits;

 edb\_id | dbname |wait\_name | wait\_count |avg\_wait | max\_wait | totalwait

\--------+--------+-----------+------------+---------+----------+----------

      1 | edb    |db fileread|        301 |0.011516 | 0.629986 | 2.742500

      1 | edb    |wal flush  |        26 |0.010364 | 0.085380 | 0.269452

      1 | edb    |wal write  |        26 |0.010355 | 0.085371 | 0.269232

      1 | edb    |query plan |        277 |0.001367 | 0.049425 | 0.192442

      2 | edb    |wal flush |        28 |0.040443 | 0.095150 | 0.431984

      2 | edb    |wal write |        28 |0.040434 | 0.095093 | 0.431698

      2 | edb    |query plan |        299 |0.001479 | 0.049425 | 0.262596

### edb$session\_waits

The edb$session\_waits view summarizes the number of waits and the total wait time per session for each wait named and identified by backend ID. It also displays the average and max wait times. edb$session\_waits summarizes the following information:

Column | Type | Modifiers |Definition

\-----------------+---------------+-----------+----------------

backend\_id | bigint | |session identifier

wait\_count | bigint | |number of times the event

occurs

avg\_wait\_time | numeric | |average wait time in

microseconds

max\_wait\_time | numeric(50,6) | |maximum wait time in

microseconds

total\_wait\_time | numeric(50,6) | |total wait time in

microseconds

wait\_name | text | |name of the event

The following code sample shows the result of a SELECT statement on the edb$session\_waits view:

SELECT \* FROM sys.edb$session\_waits;

edb\_id | dbname | backend\_id |  wait\_name    | wait\_count | avg\_wait\_time | max\_wait\_time| total\_wait\_time |  usename    |  current\_query

\--------+--------+------------+---------------+------------+---------------+--------------+-----------------+--------------+---------------------------

      1 | edb    |      22935 | db file read  |        175 |      0.008399 |      0.629986 |        1.469887 | enterprisedb | \<IDLE\>

      1 | edb    |      22988 | db file read  |        116 |      0.009556 |      0.040627 |        1.108438 | enterprisedb | select \* from edbsnap();

      1 | edb    |      22988 | wal flush     |        26 |      0.010364 |      0.085380 |        0.269452 | enterprisedb | select \* from edbsnap();

(3 rows)

### edb$session\_wait\_history

The edb$session\_wait\_history view contains the last 25 wait events for each backend ID active during the session. The edb$session\_wait\_history view includes the following information:

Column | Type | Modifiers | Definition

\------------+--------+-----------+--------------------------

edb\_id | numeric| |identifier

dbname | text | |database name

backend\_id | bigint | |session identifier

seq | bigint | |number between 1 and 25

wait\_name | text | |name of the event

elapsed | bigint | |elapsed time in microseconds

p1 | bigint | |variable \#1- meaning dependent on

event

p2 | bigint | |variable \#2- meaning dependent on

event

p3 | bigint | |variable \#3- meaning dependent on

event

The values contained in the p1, p2, and p3 columns are wait-specific. The following waits include information in those columns:

<table>
<thead>
<tr class="header">
<th>Wait Name</th>
<th>p1</th>
<th>p2</th>
<th>p3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>wal file sync</td>
<td><p>0 means Fsync</p>
<p>1 means Fdatasync</p>
<p>2 means open</p>
<p>3 means Fsync writethrough</p>
<p>4 means open dsync</p>
<p>For more information, please see the documentation for WAL_SYNC_METHOD</p></td>
<td>unused</td>
<td>unused</td>
</tr>
<tr class="even">
<td>Infinite Cache write</td>
<td>The Infinite Cache node ID that was written</td>
<td>The file ID from pg_class.relfilenode</td>
<td>The block number that was written</td>
</tr>
<tr class="odd">
<td>Infinite Cache read</td>
<td>The file ID from pg_class.relfilenode</td>
<td>The block number that was written</td>
<td>unused</td>
</tr>
<tr class="even">
<td>db file extend</td>
<td>The file ID from pg_class.relfilenode</td>
<td>The block number that was extended</td>
<td><p>Skip Fsync;</p>
<p>1 if True, 0 if False</p></td>
</tr>
<tr class="odd">
<td>db file read</td>
<td>The file ID from pg_class.relfilenode</td>
<td>The block number that was read</td>
<td>unused</td>
</tr>
<tr class="even">
<td>db file write</td>
<td>The file ID from pg_class.relfilenode</td>
<td>The block number that was written</td>
<td>unused</td>
</tr>
</tbody>
</table>

For all other event types, the p1, p2, and p3 columns are unused.

The following code sample shows the result of a SELECT statement on the edb$session\_wait\_history view:

SELECT \* FROM sys.edb$session\_wait\_history;

edb\_id | dbname | backend\_id | seq |   wait\_name   | elapsed | p1 | p2 | p3

\--------+--------+------------+-----+---------------+---------+----+----+----

      1 | edb    |      22935 |   1 | query plan   |      54 |  0 |  0 | 0

      1 | edb    |      22935 |   2 | db file read |    1116 |2689| 8 | 1

      1 | edb    |      22935 |   3 | db file read |     983 |1255| 32 |  1

      1 | edb    |      22935 |   4 | db file read  |   13717 |2691| 19 |  1

      1 | edb    |      22935 |   5 | query plan    |      75 | 0|  0 |  0

      1 | edb    |      22935 |   6 | db file read |   11053 |1255|  7 | 1

      1 | edb    |      22935 |   7 | db file read  |     404 |2689|  4 |  1

(7 rows)

